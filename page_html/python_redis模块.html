<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="referrer" content="origin">
    
    <meta http-equiv="Cache-Control" content="no-transform">
    <meta http-equiv="Cache-Control" content="no-siteapp">
    <title>小戳同学 - 博客园</title>
    
    <link rel="stylesheet" href="https://www.cnblogs.com/css/blog-common.min.css?v=sqi5FxOybx6gjGoG6Zfy1wD-0AwznLNLYOVx7Y9tIN0">
    <link id="MainCss" rel="stylesheet" href="https://www.cnblogs.com/skins/coffee/bundle-coffee.min.css?v=pdMIVgsH8kXt-vOWnlL0N20TlHt3UyP9HzGgocfsP4s">
    
    <link id="mobile-style" media="only screen and (max-width: 767px)" type="text/css" rel="stylesheet" href="https://www.cnblogs.com/skins/coffee/bundle-coffee-mobile.min.css?v=MGucLWekW6t3A88Ks-YfEzrx4X_hEIpMacbOAC9lJUs">
    
    <link type="application/rss+xml" rel="alternate" href="https://www.cnblogs.com/xiaokuangnvhai/rss">
    <link type="application/rsd+xml" rel="EditURI" href="https://www.cnblogs.com/xiaokuangnvhai/rsd.xml">
    <link type="application/wlwmanifest+xml" rel="wlwmanifest" href="https://www.cnblogs.com/xiaokuangnvhai/wlwmanifest.xml">
    <script async="" src="https://www.google-analytics.com/analytics.js"></script><script src="https://common.cnblogs.com/scripts/jquery-2.2.0.min.js"></script>
    <script src="https://www.cnblogs.com/js/blog-common.min.js?v=ruOFvx8_pDlyiWjHGHyOXclVmNo396_IKB8YFZjMllo"></script>
    <script>
        var currentBlogId = 516754;
        var currentBlogApp = 'xiaokuangnvhai';
        var cb_enable_mathjax = false;
        var isLogined = true;
    </script>  
</head><h1 class='postTitle'><a class="postTitle2" href="https://www.cnblogs.com/xiaokuangnvhai/p/11120696.html" id="cb_post_title_url">python_redis模块</a></h1<div class='postBody'><div class="blogpost-body" id="cnblogs_post_body">
<div style="white-space: pre-wrap; text-align: left; line-height: 1.75; font-size: 14px;"><span style="font-size: 12px;">Redis 是一个数据库，数据存在内存中，每秒钟能支持的10万次的读写</span></div>
<div style="white-space: pre-wrap; text-align: left; line-height: 1.75; font-size: 14px;"><span style="font-size: 12px;">关系型数据库：表，字段，sql语句操作</span></div>
<div style="white-space: pre-wrap; text-align: left; line-height: 1.75; font-size: 14px;"><span style="font-size: 12px;">非关系型数据库：nosql 没有sql语句，没有表，数据格式就是一个key，一个value</span></div>
<div style="white-space: pre-wrap; text-align: left; line-height: 1.75; font-size: 14px;"> <a href="https://www.cnblogs.com/zhaohuhu/p/9140673.html">https://www.cnblogs.com/zhaohuhu/p/9140673.html</a></div>
<div style="white-space: pre-wrap; text-align: left; line-height: 1.75; font-size: 14px;"><span style="font-size: 12px;">1、Redis连接</span></div>
<div style="white-space: pre-wrap; text-align: left; line-height: 1.75; font-size: 14px;">
<div class="cnblogs_code">
<pre><span style="color: #0000ff;">import</span><span style="color: #000000;"> redis
r</span>=redis.Redis(host=<span style="color: #800000;">'ip</span><span style="color: #800000;">'</span>,password=<span style="color: #800000;">'</span><span style="color: #800000;">HK139bc&amp;*</span><span style="color: #800000;">'</span>,db=15)  <span style="color: #008000;">#</span><span style="color: #008000;">Redis连接</span>
<span style="color: #0000ff;">print</span>(r.get(<span style="color: #800000;">'</span><span style="color: #800000;">nick</span><span style="color: #800000;">'</span>)) <span style="color: #008000;">#</span><span style="color: #008000;">返回二进制</span>
<span style="color: #0000ff;">print</span>(r.get(<span style="color: #800000;">'</span><span style="color: #800000;">nick</span><span style="color: #800000;">'</span>).decode()) <span style="color: #008000;">#</span><span style="color: #008000;">返回字符串</span>
<span style="color: #000000;">
r</span>=redis.Redis(host=<span style="color: #800000;">'</span>ip<span style="color: #800000;">'</span>,password=<span style="color: #800000;">'</span><span style="color: #800000;">HK139bc&amp;*</span><span style="color: #800000;">'</span>,db=15,decode_responses=True)<span style="color: #008000;">#</span><span style="color: #008000;">Redis连接</span>
<span style="color: #0000ff;">print</span>(r.get(<span style="color: #800000;">'</span><span style="color: #800000;">nick</span><span style="color: #800000;">'</span>)) <span style="color: #008000;">#</span><span style="color: #008000;">返回字符串</span></pre>
</div>
<p>2、Redis操作（string类型）</p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff;">import</span><span style="color: #000000;"> redis

r</span>=redis.Redis(host=<span style="color: #800000;">'</span>ip<span style="color: #800000;">'</span>,password=<span style="color: #800000;">'</span><span style="color: #800000;">HK139bc&amp;*</span><span style="color: #800000;">'</span>,db=15,decode_responses=True)<span style="color: #008000;">#</span><span style="color: #008000;">Redis连接</span>
<span style="color: #0000ff;">print</span>(r.get(<span style="color: #800000;">'</span><span style="color: #800000;">nick</span><span style="color: #800000;">'</span>))<span style="color: #008000;">#</span><span style="color: #008000;">查询且返回字符串</span>
r.set(<span style="color: #800000;">'</span><span style="color: #800000;">nick2</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">xiaobai</span><span style="color: #800000;">'</span>) <span style="color: #008000;">#</span><span style="color: #008000;">新增</span>
r.set(<span style="color: #800000;">'</span><span style="color: #800000;">nick2</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">xiaohei</span><span style="color: #800000;">'</span>) <span style="color: #008000;">#</span><span style="color: #008000;">修改 Key不能重复，重复后覆盖原来的值</span>
r.delete(<span style="color: #800000;">'</span><span style="color: #800000;">nick</span><span style="color: #800000;">'</span>) <span style="color: #008000;">#</span><span style="color: #008000;">删除</span>
r.set(<span style="color: #800000;">'</span><span style="color: #800000;">zwj_nick:jjj</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">xiaobai</span><span style="color: #800000;">'</span>) <span style="color: #008000;">#</span><span style="color: #008000;">多级 zwj_nick为文件夹，文件夹下key是jjj，value是xiaobai</span>
r.set(<span style="color: #800000;">'</span><span style="color: #800000;">nick</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">xiaobai</span><span style="color: #800000;">'</span>,60) <span style="color: #008000;">#</span><span style="color: #008000;">60代表失效时间，不设置代表永久，失效后移除Redis</span>
r.set(<span style="color: #800000;">'</span><span style="color: #800000;">zwj_nick:jjj</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">xiaobai</span><span style="color: #800000;">'</span>,60) <span style="color: #008000;">#</span><span style="color: #008000;">60代表失效时间，不设置代表永久，失效后移除Redis</span>
<span style="color: #0000ff;">print</span>(r.keys()) <span style="color: #008000;">#</span><span style="color: #008000;">所有key的集合</span>
<span style="color: #0000ff;">print</span>(r.keys(<span style="color: #800000;">'</span><span style="color: #800000;">nick*</span><span style="color: #800000;">'</span>)) <span style="color: #008000;">#</span><span style="color: #008000;">模糊查询key，*号为通配符</span>
<span style="color: #0000ff;">print</span>(r.exists(<span style="color: #800000;">'</span><span style="color: #800000;">nick</span><span style="color: #800000;">'</span>)) <span style="color: #008000;">#</span><span style="color: #008000;">判断KEY是否存在,存在返回1，不存在返回0</span>
r.flushall() <span style="color: #008000;">#</span><span style="color: #008000;">清空所有库的KEY</span>
r.flushdb() <span style="color: #008000;">#</span><span style="color: #008000;">清空Redis所有的库</span></pre>
</div>
<p> 3、Redis 操作（hash类型）</p>
<p>hash类型2个key,如下内容：一级key是name，二级key是zwj5,zwj6</p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff;">import</span><span style="color: #000000;"> redis

r</span>=redis.Redis(host=<span style="color: #800000;">'</span><span style="color: #800000;">ip</span><span style="color: #800000;">'</span>,password=<span style="color: #800000;">'</span><span style="color: #800000;">HK139bc&amp;*</span><span style="color: #800000;">'</span>,db=15,decode_responses=True)<span style="color: #008000;">#</span><span style="color: #008000;">Redis连接 db不写，默认用第一个</span>
r.hset(<span style="color: #800000;">"</span><span style="color: #800000;">name</span><span style="color: #800000;">"</span>,<span style="color: #800000;">"</span><span style="color: #800000;">zwj5</span><span style="color: #800000;">"</span>,<span style="color: #800000;">'</span><span style="color: #800000;">123456</span><span style="color: #800000;">'</span><span style="color: #000000;">)
r.hset(</span><span style="color: #800000;">"</span><span style="color: #800000;">name</span><span style="color: #800000;">"</span>,<span style="color: #800000;">"</span><span style="color: #800000;">zwj6</span><span style="color: #800000;">"</span>,<span style="color: #800000;">"</span><span style="color: #800000;">123456</span><span style="color: #800000;">"</span>)</pre>
</div>
<p><img alt="" src="https://img2018.cnblogs.com/blog/783015/201907/783015-20190704094159309-2051647814.png"/></p>
<p> </p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff;">import</span><span style="color: #000000;"> redis

r</span>=redis.Redis(host=<span style="color: #800000;">'</span>IP<span style="color: #800000;">'</span>,password=<span style="color: #800000;">'</span><span style="color: #800000;">HK139bc&amp;*</span><span style="color: #800000;">'</span>,db=15,decode_responses=True)<span style="color: #008000;">#</span><span style="color: #008000;">Redis连接 db不写，默认用第一个</span>
r.hset(<span style="color: #800000;">"</span><span style="color: #800000;">name</span><span style="color: #800000;">"</span>,<span style="color: #800000;">"</span><span style="color: #800000;">zwj5</span><span style="color: #800000;">"</span>,<span style="color: #800000;">'</span><span style="color: #800000;">123456</span><span style="color: #800000;">'</span>) <span style="color: #008000;">#</span><span style="color: #008000;">增加</span>
r.hset(<span style="color: #800000;">"</span><span style="color: #800000;">name</span><span style="color: #800000;">"</span>,<span style="color: #800000;">"</span><span style="color: #800000;">zwj5</span><span style="color: #800000;">"</span>,<span style="color: #800000;">"</span><span style="color: #800000;">1234566</span><span style="color: #800000;">"</span>) <span style="color: #008000;">#</span><span style="color: #008000;">修改，覆盖原来的内容</span>

<span style="color: #0000ff;">print</span>(r.hget(<span style="color: #800000;">"</span><span style="color: #800000;">name</span><span style="color: #800000;">"</span>,<span style="color: #800000;">"</span><span style="color: #800000;">zwj5</span><span style="color: #800000;">"</span>)) <span style="color: #008000;">#</span><span style="color: #008000;">返回小key内容，返回str类型</span>
<span style="color: #0000ff;">print</span>(r.hgetall(<span style="color: #800000;">"</span><span style="color: #800000;">name</span><span style="color: #800000;">"</span>)) <span style="color: #008000;">#</span><span style="color: #008000;">获取大key内容，返回字典类型</span>
<span style="color: #000000;">
r.hdel(</span><span style="color: #800000;">"</span><span style="color: #800000;">name</span><span style="color: #800000;">"</span>,<span style="color: #800000;">"</span><span style="color: #800000;">zwj5</span><span style="color: #800000;">"</span>) <span style="color: #008000;">#</span><span style="color: #008000;">删除小KEY</span>
r.delete(<span style="color: #800000;">"</span><span style="color: #800000;">name</span><span style="color: #800000;">"</span>)<span style="color: #008000;">#</span><span style="color: #008000;">删除大key</span>
r.hmset(<span style="color: #800000;">"</span><span style="color: #800000;">name</span><span style="color: #800000;">"</span>,{<span style="color: #800000;">"</span><span style="color: #800000;">zwj7</span><span style="color: #800000;">"</span>:124,<span style="color: #800000;">"</span><span style="color: #800000;">zwj8</span><span style="color: #800000;">"</span>:234}) <span style="color: #008000;">#</span><span style="color: #008000;">批量添加</span>
<span style="color: #0000ff;">print</span>(r.hmget(<span style="color: #800000;">"</span><span style="color: #800000;">name</span><span style="color: #800000;">"</span>,[<span style="color: #800000;">'</span><span style="color: #800000;">zwj7</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">zwj8</span><span style="color: #800000;">'</span>])) <span style="color: #008000;">#</span><span style="color: #008000;">批量获取指定KEY的值</span>

<span style="color: #0000ff;">print</span>(r.type(<span style="color: #800000;">"</span><span style="color: #800000;">name</span><span style="color: #800000;">"</span>)) <span style="color: #008000;">#</span><span style="color: #008000;">获取key的数据类型</span>
<span style="color: #0000ff;">print</span>(r.exists(<span style="color: #800000;">"</span><span style="color: #800000;">name</span><span style="color: #800000;">"</span>)) <span style="color: #008000;">#</span><span style="color: #008000;">存在返回1，不存在返回0</span>
r.expire(<span style="color: #800000;">"</span><span style="color: #800000;">name</span><span style="color: #800000;">"</span>,60)<span style="color: #008000;">#</span><span style="color: #008000;">设置失效时间</span></pre>
</div>
<p> 备注：Redis管理工具查看KEY失效时间</p>
<div style="text-align: left; float: none;">
<div style="text-align: left; float: none;"><img alt="" src="https://img2018.cnblogs.com/blog/783015/201907/783015-20190704111651659-706461112.png"/>
<p> </p>
</div>
</div>
</div>
</div></div>