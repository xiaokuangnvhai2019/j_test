<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="referrer" content="origin">
    
    <meta http-equiv="Cache-Control" content="no-transform">
    <meta http-equiv="Cache-Control" content="no-siteapp">
    <title>小戳同学 - 博客园</title>
    
    <link rel="stylesheet" href="https://www.cnblogs.com/css/blog-common.min.css?v=sqi5FxOybx6gjGoG6Zfy1wD-0AwznLNLYOVx7Y9tIN0">
    <link id="MainCss" rel="stylesheet" href="https://www.cnblogs.com/skins/coffee/bundle-coffee.min.css?v=pdMIVgsH8kXt-vOWnlL0N20TlHt3UyP9HzGgocfsP4s">
    
    <link id="mobile-style" media="only screen and (max-width: 767px)" type="text/css" rel="stylesheet" href="https://www.cnblogs.com/skins/coffee/bundle-coffee-mobile.min.css?v=MGucLWekW6t3A88Ks-YfEzrx4X_hEIpMacbOAC9lJUs">
    
    <link type="application/rss+xml" rel="alternate" href="https://www.cnblogs.com/xiaokuangnvhai/rss">
    <link type="application/rsd+xml" rel="EditURI" href="https://www.cnblogs.com/xiaokuangnvhai/rsd.xml">
    <link type="application/wlwmanifest+xml" rel="wlwmanifest" href="https://www.cnblogs.com/xiaokuangnvhai/wlwmanifest.xml">
    <script async="" src="https://www.google-analytics.com/analytics.js"></script><script src="https://common.cnblogs.com/scripts/jquery-2.2.0.min.js"></script>
    <script src="https://www.cnblogs.com/js/blog-common.min.js?v=ruOFvx8_pDlyiWjHGHyOXclVmNo396_IKB8YFZjMllo"></script>
    <script>
        var currentBlogId = 516754;
        var currentBlogApp = 'xiaokuangnvhai';
        var cb_enable_mathjax = false;
        var isLogined = true;
    </script>  
</head><h1 class='postTitle'><a class="postTitle2" href="https://www.cnblogs.com/xiaokuangnvhai/p/11423145.html" id="cb_post_title_url">ant+Jenkins+jmeter</a></h1<div class='postBody'><div class="blogpost-body" id="cnblogs_post_body">
<p>一、Linux 安装ant</p>
<p>ant 下载地址：<a href="https://ant.apache.org/bindownload.cgi">https://ant.apache.org/bindownload.cgi</a></p>
<p>下载后通过rz命令把文件上传到Linux对应的文件夹，这里我下载的是apache-ant-1.9.14-bin.tar.gz</p>
<p>通过tar -xvf apache-ant-1.9.14-bin.tar.gz 解压</p>
<p> </p>
<p>配置环境变量及验证安装是否成功</p>
<p>环境变量为bin的目录路径</p>
<p><img alt="" src="https://img2018.cnblogs.com/blog/783015/201908/783015-20190828214249512-870840188.png"/></p>
<p> </p>
<p> 二、安装Jenkins</p>
<p>参考博客连接：https://www.cnblogs.com/xiaokuangnvhai/p/11343003.html</p>
<p> </p>
<p>三、创建ant的Git仓库</p>
<div class="cnblogs_Highlighter">
<pre class="brush:csharp;gutter:true;">mkdir ant #创建文件夹
cd ant #切换到该目录下
git init --bare ant.git #把该目录变为Git仓库

</pre>
</div>
<p> </p>
<p>四、获取远程仓库并上传脚本</p>
<div class="cnblogs_code">
<pre><span style="color: #000000;">远程克隆仓库<br/></span></pre>
<pre class="hljs ruby"><code class="ruby">git clone git@server<span class="hljs-symbol">:ant/ant.git</span></code></pre>
<pre><span style="color: #000000;"><br/>build.xml  #本地建XML配置文件
script   #建脚本目录
result_log #建结果目录<br/><br/>#切换到结果目录
html #建报告目录
jtl    #结果目录<br/><br/>把做好的jmeter脚本放入script脚本中<br/><br/><br/>git add . #添加所有文件<br/>git commit -m "your remark" #将代码提交到本地仓库<br/>git push --set-upstream origin master  #将代码上传到远程仓库并把本地上传的代码设为master分支<br/></span></pre>
</div>
<p>修改build.xml文件，注意文件路径用Jenkins工作路径</p>
<div class="cnblogs_Highlighter">
<pre class="brush:csharp;gutter:true;"> &lt;?xml version="1.0" encoding="utf-8"?&gt;<br/>&lt;project name="zwj_test" default="all" basedir="."&gt;<br/>    &lt;tstamp&gt;<br/>        &lt;format property="time" pattern="yyyyMMddhhmm" /&gt;<br/>    &lt;/tstamp&gt;<br/>    &lt;!-- 需要改成自己本地的 Jmeter 目录--&gt;<br/>    &lt;property name="jmeter.home" value="/usr/ant-jmeter/apache-jmeter-5.0" /&gt;<br/>    &lt;!-- jmeter生成jtl格式的结果报告的路径--&gt;<br/>    &lt;property name="jmeter.result.jtl.dir" value="/var/lib/jenkins/workspace/ant_test3/result_log/jtl" /&gt;<br/>    &lt;!-- jmeter生成html格式的结果报告的路径--&gt;<br/>    &lt;property name="jmeter.result.html.dir" value="/var/lib/jenkins/workspace/ant_test3/result_log/html" /&gt;<br/>    &lt;!-- 生成的报告的前缀 --&gt;<br/>    &lt;property name="ReportName" value="TestReport" /&gt;<br/>    &lt;property name="jmeter.result.jtlName" value="${jmeter.result.jtl.dir}/${ReportName}${time}.jtl" /&gt;<br/>    &lt;property name="jmeter.result.htmlName" value="${jmeter.result.html.dir}/${ReportName}${time}.html" /&gt;<br/>    &lt;!-- 接收测试报告的邮箱 --&gt;<br/>    &lt;property name="mail_to" value="540493450@qq.com" /&gt;<br/>    &lt;target name="all"&gt;<br/>        &lt;antcall target="test" /&gt;<br/>        &lt;antcall target="report" /&gt;<br/>    &lt;/target&gt;<br/>    &lt;target name="test"&gt;<br/>        &lt;taskdef name="jmeter" classname="org.programmerplanet.ant.taskdefs.jmeter.JMeterTask" /&gt;<br/>        &lt;jmeter jmeterhome="${jmeter.home}" resultlog="${jmeter.result.jtlName}"&gt;<br/>            &lt;!-- 声明要运行的脚本。"*.jmx"指包含此目录下的所有jmeter脚本 --&gt;<br/>            &lt;testplans dir="/var/lib/jenkins/workspace/ant_test3/script" includes="*.jmx" /&gt;<br/>            &lt;property name="jmeter.save.saveservice.output_format" value="xml"/&gt;<br/>        &lt;/jmeter&gt;<br/>    &lt;/target&gt;<br/>    &lt;path id="xslt.classpath"&gt;<br/>        &lt;fileset dir="${jmeter.home}/lib" includes="xalan*.jar"/&gt;<br/>        &lt;fileset dir="${jmeter.home}/lib" includes="serializer*.jar"/&gt;<br/>    &lt;/path&gt;<br/>    &lt;target name="report"&gt;<br/>        &lt;xslt classpathref="xslt.classpath" force="true" in="${jmeter.result.jtlName}" out="${jmeter.result.htmlName}" style="${jmeter.home}/extras/jmeter-results-report_zw.xsl" <br/>        &gt;<br/>         &lt;param name="dateReport" expression="${report.datestamp}"/&gt;<br/>         &lt;/xslt&gt;<br/>        &lt;!-- 因为上面生成报告的时候，不会将相关的图片也一起拷贝至目标目录，所以，需要手动拷贝 --&gt;<br/>        &lt;copy todir="${jmeter.result.html.dir}"&gt;<br/>            &lt;fileset dir="${jmeter.home}/extras"&gt;<br/>                &lt;include name="collapse.png" /&gt;<br/>                &lt;include name="expand.png" /&gt;<br/>            &lt;/fileset&gt;<br/>        &lt;/copy&gt;<br/>    &lt;/target&gt;<br/>    &lt;!-- 发送邮件 --&gt;<br/>&lt;/project&gt;<br/><br/>

</pre>
</div>
<p> 五、Jenkins设置</p>
<p>1、安装及配置插件</p>
<ul>
<li>配置JDK</li>
<li>配置Ant</li>
<li>配置Git</li>
<li>下载插件 Ant Plugin</li>
<li>下载插件 HTML Publisher Plugin</li>
<li>下载插件 Email Extension Plugin</li>
</ul>
<p> a、jdk、git 及ant配置，配置如下：</p>
<p>注意事项：home变量配置安装路径，自动安装不勾选，名称自定义</p>
<p> </p>
<p><img alt="" src="https://img2018.cnblogs.com/blog/783015/201908/783015-20190830140616802-1126906846.png"/></p>
<p> </p>
<p> </p>
<p><img alt="" src="https://img2018.cnblogs.com/blog/783015/201908/783015-20190830140718102-1322337733.png"/></p>
<p> </p>
<p> </p>
<p>2、新建自由风格任务，源码管理选择Git</p>
<p><img alt="" src="https://img2018.cnblogs.com/blog/783015/201908/783015-20190830140945461-2068816255.png"/></p>
<p> </p>
<p> </p>
<p>3、构建环境选择ant，设置如下</p>
<p>使用Git管理源码，target无需填写，默认的路径就是当前项目地址</p>
<p><img alt="" src="https://img2018.cnblogs.com/blog/783015/201908/783015-20190830141104618-1121603039.png"/></p>
<p> </p>
<p> </p>
<p> 4、邮件配置</p>
<p>配置详解：文档：Jenkins 邮件发送配置.note<br/>链接：http://note.youdao.com/noteshare?id=b0ca20209c73e9c00ef76ebbb63c896f&amp;sub=WEB1f1fb4c7b34167f7d955dddb999dd2d8</p>
<p> </p>
<p>注意事项：加触发发送邮件的点以及设置发送格式为HTML</p>
<p> </p>
<p>5、构建任务，发送测试完成邮件</p>
<p><img alt="" src="https://img2018.cnblogs.com/blog/783015/201908/783015-20190830145833605-1757938522.png"/></p>
<p> </p>
</div></div>